---
title: æˆ‘åšäº†ä¸€ä¸ªæ‰‹å†™æ˜¥è”å°ç½‘é¡µï¼Œç¥å¤§å®¶è™å¹´æš´å¯Œ
date: 2022-01-28 14:59:51
permalink: /pages/829589/
titleTag: åŸåˆ›
sidebar: auto
categories:
  - éšç¬”
tags:
  -
---



<p align="center"><img src="https://img-blog.csdnimg.cn/img_convert/185c88180b87ac7277072280a0c144ce.png" width="500" style="cursor: zoom-in;"></p>

æ‰‹å†™æ˜¥è”ï¼š<https://cl.xugaoyi.com/>

### å‰è¨€
è™å¹´æ˜¥èŠ‚å¿«åˆ°äº†ï¼Œé¦–å…ˆç¥å¤§å®¶æ–°å¹´å¿«ä¹ï¼Œè½»æ¾æš´å¯Œã€‚
æœ€è¿‘åœ¨ç½‘ä¸Šç»å¸¸çœ‹åˆ°ç”Ÿæˆæ˜¥è”çš„æ–‡ç« ï¼Œä¸è¿‡è¿™äº›å°demoè¦ä¹ˆåŠŸèƒ½ç®€é™‹,è¦ä¹ˆUIç‰¹åˆ«â€˜ç¨‹åºå‘˜â€™ï¼Œæ»¡è¶³ä¸äº†æˆ‘æŒ‘å‰”çš„çœ¼å…‰ã€‚å¹²è„†æˆ‘è‡ªå·±åšä¸€ä¸ªå§ï¼Œé¡ºä¾¿ç®€å•ä½“éªŒä¸€ä¸‹vite+vue3ã€‚ï¼ˆå› ä¸ºé¡µé¢ç›¸å¯¹ç®€å•ï¼Œvueç»„ä»¶é£æ ¼è¿˜æ˜¯ä½¿ç”¨é€‰é¡¹å¼apiï¼Œé‡ç‚¹è¿˜æ˜¯æƒ³æŠŠäº§å“å¿«é€Ÿåšå‡ºæ¥ã€‚ï¼‰

<!-- more -->

### äº§å“æ„æ€
åŒ…å«`æ‰‹å†™æ˜¥èŠ‚`å’Œ`ç”Ÿæˆæ˜¥è”`ä¸¤å¤§åŠŸèƒ½ï¼š
- **æ‰‹å†™æ˜¥è”**
  - æ¨¡æ‹Ÿç”¨ç¬”å†™å­—çš„å­—è¿¹
  - é€‰æ‹©ç”»ç¬”é¢œè‰²
  - è°ƒæ•´ç”»ç¬”å¤§å°
  - æ¸…ç©ºç”»å¸ƒ
  - æ’¤å›ç¬”ç”»
  - åˆ‡æ¢ä¸Šã€ä¸‹è”ã€æ¨ªæ‰¹ã€ç¦å­—
  - éšæœºåˆ‡æ¢å¯¹è”æç¤º
  - é¢„è§ˆå›¾ç‰‡å’Œä¸‹è½½
  - è´´æ˜¥è”æµ·æŠ¥å’Œä¸‹è½½

- **ç”Ÿæˆæ¨¡å¼**
  - é€‰æ‹©ç”»ç¬”é¢œè‰²
  - æŒ‘é€‰ç”Ÿæˆçš„å¯¹è”
  - è¾“å…¥å¯¹è”
  - éšæœºåˆ‡æ¢å¯¹è”
  - è´´æ˜¥è”æµ·æŠ¥å’Œä¸‹è½½

- **å…¶ä»–**
  - å¿«é€Ÿåˆ‡æ¢æ¨¡å¼æŒ‰é’®
  - å¯æ§åˆ¶çš„èƒŒæ™¯éŸ³ä¹
  - å¾®ä¿¡åˆ†äº«ç½‘é¡µ

### è®¾è®¡
![222.jpg](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/392f2036c0ce4c97b8562e6f17606491~tplv-k3u1fbpfcp-watermark.image?)

### å¼€å‘
- **æŠ€æœ¯æ ˆ**
  - vite (æ‰“åŒ…&æ„å»º)
  - vue3 (é¡µé¢å¼€å‘)
  - vantï¼ˆuiï¼‰
  - sass (css)
  - [smooth-signature.js (å¸¦ç¬”é”‹æ‰‹å†™åº“)](https://github.com/linjc/smooth-signature)


``` js
<template>
  <div class="wrap" :class="'mode-' + mode" @touchstart="handleTouchstart">
    <!-- åˆ‡æ¢æ¨¡å¼æŒ‰é’® -->
    <div class="toggle-mode-btn" @click="toggleMode">
      {{ mode === 1 ? 'æ‰‹å†™' : 'ç”Ÿæˆ' }}
      <i class="iconfont icon-qiehuan"></i>
    </div>

    <!-- å·¥å…·æ  -->
    <div
      class="actions"
      :style="{ borderTopRightRadius: colorListVisibility ? '0' : '5px' }"
    >
      <!-- æ‰‹å†™æ¨¡å¼æ˜¾ç¤º -->
      <template v-if="mode === 1">
        <!-- è°ƒè‰²æ¿ -->
        <div class="palette btn-block">
          <div
            class="cur-color"
            @click="togglePalette"
            :style="{ background: colorList[curColorIndex] }"
          ></div>
          <ul class="colorList" v-show="colorListVisibility">
            <li
              v-for="(item, index) in colorList"
              :key="item"
              :style="{ background: item }"
              @click="selectColor(index)"
            ></li>
          </ul>
        </div>

        <!-- æ»‘å— -->
        <div class="slider-box btn-block">
          <van-slider
            v-model="progress"
            vertical
            @change="changeProgress"
            bar-height="28"
            active-color="transparent"
            :min="50"
            :max="150"
          >
            <template #button>
              <div class="custom-button"></div>
            </template>
          </van-slider>
        </div>

        <!-- æ¸…ç©º -->
        <div class="btn" @click="handleClear">
          <i class="iconfont icon-lajitong"></i>
        </div>

        <!-- æ’¤é”€ -->
        <div class="btn" @click="handleUndo">
          <i class="iconfont icon-fanhui"></i>
        </div>

        <div class="line"></div>

        <!-- åˆ‡æ¢ç”»å¸ƒçš„æŒ‰é’® -->
        <div
          class="btn"
          :class="{ 'cur-active': curCanvasIndex === index }"
          v-for="(item, index) in canvasList"
          :key="item.name"
          @click="changeCanvas(index)"
        >
          {{ item.name }}
        </div>

        <div class="line"></div>

        <div class="btn prominent" @click="handlePreview">é¢„è§ˆ</div>
        <div class="btn prominent" @click="openPosters">è´´è”</div>
      </template>

      <!-- ç”Ÿæˆæ¨¡å¼æ˜¾ç¤º -->
      <template v-else>
        <!-- é€‰é¢œè‰² -->
        <div
          class="color-list-quick"
          :class="{ active: curColorIndex === index }"
          v-for="(item, index) in colorList"
          :key="item"
          :style="{ background: item }"
          @click="selectColor(index)"
        ></div>
        <div class="line"></div>
        <div class="btn" @click="showPickBox = true">æŒ‘é€‰</div>
        <div class="btn" @click="showInputBox = true">è¾“å…¥</div>

        <!-- æŒ‘é€‰å¯¹è”å¼¹çª— -->
        <van-action-sheet v-model:show="showPickBox" title="è¯·æŒ‘é€‰å¯¹è”">
          <ul class="duilian-list">
            <li
              v-for="(item, index) in duilianList"
              :key="index"
              @click="handlePickDuilian(item)"
            >
              <span>{{ item.shang }}</span
              >ï¼Œ <span>{{ item.xia }}</span
              >ã€‚
              <span>{{ item.heng }}</span>
            </li>
          </ul>
        </van-action-sheet>

        <!-- è¾“å…¥å¯¹è”å¼¹çª— -->
        <van-action-sheet v-model:show="showInputBox" title="è¯·è¾“å…¥å¯¹è”">
          <van-form @submit="handleSubmitInput">
            <van-cell-group inset>
              <van-field
                v-model="shanglian"
                name="shang"
                label="ä¸Šè”"
                placeholder="ä¸Šè”"
                :rules="[
                  {
                    required: true,
                    message: 'è¯·è¾“å…¥7ä½æ±‰å­—ä¸Šè”',
                    pattern: /^[\u4e00-\u9fa5]{7}$/
                  }
                ]"
                clearable
              />
              <van-field
                v-model="xialian"
                name="xia"
                label="ä¸‹è”"
                placeholder="ä¸‹è”"
                :rules="[
                  {
                    required: true,
                    message: 'è¯·è¾“å…¥7ä½æ±‰å­—ä¸‹è”',
                    pattern: /^[\u4e00-\u9fa5]{7}$/
                  }
                ]"
                clearable
              />
              <van-field
                v-model="hengpi"
                name="heng"
                label="æ¨ªæ‰¹"
                placeholder="æ¨ªæ‰¹"
                :rules="[
                  {
                    required: true,
                    message: 'è¯·è¾“å…¥4ä½æ±‰å­—æ¨ªæ‰¹',
                    pattern: /^[\u4e00-\u9fa5]{4}$/
                  }
                ]"
                clearable
              />
            </van-cell-group>
            <div style="margin: 16px">
              <van-button
                round
                block
                type="primary"
                native-type="submit"
                color="linear-gradient(to right, #ff6034, #c33825)"
              >
                å®Œæˆ
              </van-button>
            </div>
          </van-form>
        </van-action-sheet>
      </template>
    </div>

    <!-- æ¨¡å¼1-æ˜¥è”ç”»å¸ƒ -->
    <div
      v-show="mode === 1"
      v-for="(item, index) in canvasList"
      :key="item.name"
    >
      <canvas
        class="canvas"
        :class="item.className"
        v-show="curCanvasIndex === index"
        :style="{
          marginTop:
            item.height < clientHeight
              ? `${(clientHeight - item.height) / 2}px`
              : 0,
          marginLeft:
            item.width < clientWidth ? `${(clientWidth - item.width) / 2}px` : 0
        }"
      />
    </div>

    <!-- æ¨¡å¼2-æ˜¥è”ç”»å¸ƒ -->
    <div v-show="mode === 2" class="canvas-mode-2">
      <div class="row">
        <canvas id="canvas-top" :width="200 * scale" :height="60 * scale" />
      </div>
      <div class="row">
        <canvas id="canvas-left" :width="60 * scale" :height="364 * scale" />
        <canvas id="canvas-right" :width="60 * scale" :height="364 * scale" />
      </div>
    </div>

    <!-- è´´æ˜¥è”æŒ‰é’® -->
    <Button class="btn-posters" @click="openPosters" />

    <!-- footer-å½“å‰å¯¹è”æç¤º -->
    <footer v-if="duilian.shang">
      <div class="refresh-btn" @click="handleRefresh(true)">
        <i class="iconfont icon-shuaxin" :class="{ rotate: isRotate }"></i>
      </div>
      <dl class="duilian">
        <dt>å¯¹è”</dt>
        <dd>
          <div>{{ duilian.shang }}</div>
          <div>{{ duilian.xia }}</div>
        </dd>
      </dl>
      <dl>
        <dt>æ¨ªæ‰¹</dt>
        <dd>{{ duilian.heng }}</dd>
      </dl>
    </footer>

    <!-- åˆ†äº«æŒ‰é’® -->
    <div class="share-btn" v-if="isShowShareBtn" @click="isShowShareTip = true">
      <i class="iconfont icon-fenxiang"></i>
    </div>
    <!-- å¾®ä¿¡åˆ†äº«æç¤ºè¯­ -->
    <div
      class="share-tip"
      v-if="isShowShareTip"
      @click="isShowShareTip = false"
    >
      ç‚¹å‡»å³ä¸Šè§’æŠŠè¿™ä¸ªå·¥å…·åˆ†äº«ç»™æœ‹å‹
      <div class="hand">ğŸ‘†</div>
    </div>

    <!-- ä¿å­˜tip -->
    <p v-if="isShowTip" class="download-tip">*é•¿æŒ‰å›¾ç‰‡ä¿å­˜æˆ–è½¬å‘</p>

    <!-- ç‰ˆæƒ -->
    <div class="copyright">å…¬ä¼—å·ã€Œæœ‰è¶£ç ”ç©¶ç¤¾ã€ Â©ç‰ˆæƒæ‰€æœ‰</div>

    <!-- è½½å…¥å›¾ç‰‡å…ƒç´ ï¼Œç”¨äºå¿«é€Ÿè´´å›¾ä½¿ç”¨, æ³¨æ„è®¾ç½®crossorigin="anonymous"è§£å†³è·¨åŸŸ -->
    <div v-if="isReadImages">
      <img
        crossorigin="anonymous"
        v-for="(item, index) in bgList"
        :src="item"
        :key="item"
        class="hide-img"
        :id="`bg-img-` + index"
      />
      <img
        crossorigin="anonymous"
        class="hide-img"
        id="qrcode"
        src="https://cdn.jsdelivr.net/gh/xugaoyi/image_store2@master/img/qrcode.zul0pldsuao.png"
      />
    </div>

    <!-- èƒŒæ™¯éŸ³ä¹ -->
    <audio
      src="https://cdn.jsdelivr.net/gh/xugaoyi/image_store2@master/cjxq.mp3"
      id="bgm"
      ref="bgm"
      loop
    />
    <div
      class="play-btn"
      :class="{ paused: !isPlay }"
      ref="playBtn"
      @click="handlePlay"
    >
      <i class="iconfont icon-yinle"></i>
    </div>
  </div>

  <div class="body-bg-img"></div>
</template>

<script>
import { ImagePreview, Notify } from 'vant'
import { isWX, isMobile } from '@/utils'
import Button from '@/components/Button.vue'
import dl from '@/assets/img/yh/dl.jpeg'
import hp from '@/assets/img/yh/hp.jpeg'
import fz from '@/assets/img/yh/fz.png'

// å¯¹è”æ•°æ®
import duilianList from '@/mock/duilian'

const PROPORTION = 0.37 // å›¾ç‰‡ç¼©å°æ¯”ä¾‹
const INSTANTIATE_NAME = 'signature' // å®ä¾‹åç§°
const MIN_WIDTH = 3 // ç”»ç¬”æœ€å°å®½
const MAX_WIDTH = 12 // ç”»ç¬”æœ€å¤§å®½

// æµ·æŠ¥èƒŒæ™¯å›¾å¤§å°
const BG_WIDTH = 750
const BG_HEIGHT = 1448

// è´´å›¾å®šä½å’Œå¤§å°
const POSITION = [
  { left: 57, top: 510, width: 90, height: 546 }, // ä¸Šè”
  { left: 600, top: 510, width: 90, height: 546 }, // ä¸‹è”
  { left: 225, top: 345, width: 300, height: 90 }, // æ¨ªå¹…
  { left: 460, top: 450, width: 130, height: 130 }, // ç¦å­—
]

export default {
  name: "Home",
  components: {
    Button
  },
  data() {
    return {
      duilianList,
      mode: Number(localStorage.getItem('mode')) || 1, // 1 æ‰‹å†™ï¼Œ2 ç”Ÿæˆ
      curCanvasIndex: 0, // æ˜¾ç¤ºå“ªä¸ªç”»å¸ƒ
      progress: 100, // ç”»ç¬”å¤§å°çš„åˆ»åº¦
      clientWidth: document.documentElement.clientWidth,
      clientHeight: document.documentElement.clientHeight,
      canvasList: [
        {
          name: 'ä¸Šè”',
          className: 'canvas-a',
          bgImage: dl,
          width: 600 * PROPORTION,
          height: 3640 * PROPORTION,
        },
        {
          name: 'ä¸‹è”',
          className: 'canvas-b',
          bgImage: dl,
          width: 600 * PROPORTION,
          height: 3640 * PROPORTION,
        },
        {
          name: 'æ¨ªæ‰¹',
          className: 'canvas-c',
          bgImage: hp,
          width: 2000 * PROPORTION,
          height: 600 * PROPORTION,
        },
        {
          name: 'ç¦å­—',
          className: 'canvas-d',
          bgImage: fz,
          width: 366,
          height: 366,
        }
      ],
      colorList: ['#000000', '#ffd800', '#e8bd48', '#ddc08c',],
      curColorIndex: 0,
      colorListVisibility: false, // ç”»å¸ƒé¢œè‰²é€‰æ‹©åˆ—è¡¨å¯è§æ€§
      isShowTip: false, // æ˜¯å¦æ˜¾ç¤ºåº•éƒ¨æç¤ºè¯­
      duilian: {}, // å½“å‰å¯¹è”æ–‡æœ¬å¯¹è±¡
      isRotate: false, // åˆ·æ–°iconæ—‹è½¬
      bgList: [
        'https://cdn.jsdelivr.net/gh/xugaoyi/image_store@master/1.4j8qpdnq80i0.jpeg',
        'https://cdn.jsdelivr.net/gh/xugaoyi/image_store@master/4.4460an8ag5o0.jpeg',
        'https://cdn.jsdelivr.net/gh/xugaoyi/image_store@master/5.3axtl4xpvy00.jpeg',
        'https://cdn.jsdelivr.net/gh/xugaoyi/image_store@master/6.2lnbphdqjaq0.jpeg',
      ],
      isReadImages: false, // å»¶è¿ŸåŠ è½½å›¾ç‰‡ç”¨
      isShowShareBtn: false, // æ˜¯å¦æ˜¾ç¤ºåˆ†äº«æŒ‰é’®
      isShowShareTip: false, // æ˜¯å¦æ˜¾ç¤ºåˆ†äº«æç¤ºè¯­
      isPlay: false, // æ˜¯å¦åœ¨æ’­æ”¾

      // æ¨¡å¼2
      canvasTop: null, // æ¨ªæ‰¹
      canvasLeft: null, // ä¸Šè”
      canvasRight: null, // ä¸‹è”
      imgObj1: null, // æ¨ªæ‰¹å›¾ç‰‡å¯¹è±¡
      imgObj2: null, // ä¸Šä¸‹è”å›¾ç‰‡å¯¹è±¡
      scale: Math.max(window.devicePixelRatio || 1, 2), // ç”¨äºå¢åŠ ç”»å¸ƒæ¸…æ™°åº¦
      showPickBox: false, // æŒ‘é€‰å¯¹è”çš„å¼¹æ¡†
      showInputBox: false, // è¾“å…¥å¯¹è”çš„å¼¹æ¡†
      shanglian: '', // è¾“å…¥çš„ä¸Šè”
      xialian: '', // è¾“å…¥çš„ä¸‹è”
      hengpi: '', // è¾“å…¥çš„æ¨ªæ‰¹
    };
  },
  computed: {
    // æ¨¡å¼1-å½“å‰ç”»å¸ƒå®ä¾‹
    curCanvasInstantiate() {
      return this[INSTANTIATE_NAME + this.curCanvasIndex]
    }
  },
  created() {
    // å¾®ä¿¡æµè§ˆå™¨æ˜¾ç¤ºåˆ†äº«æŒ‰é’®
    this.isShowShareBtn = isWX()
  },
  mounted() {
    if (!isMobile()) {
      Notify({ type: 'warning', message: 'è¯·ç”¨ç§»åŠ¨ç«¯æ‰“å¼€è·å¾—æœ€ä½³ä½“éªŒ', duration: 6000, });
    }

    this.initMode1();

    // åˆå§‹åŒ–å¯¹è”æç¤º
    this.handleRefresh();

    this.initMode2();

    // æŒ‰é’®æ·»åŠ æ¿€æ´»æ—¶å‘å…‰æ•ˆæœclass
    const btnEl = document.querySelectorAll('.btn,.btn-block');
    btnEl.forEach((item) => {
      item.addEventListener('touchstart', () => {
        item.classList.add('btn-active')
      })
      item.addEventListener('touchend', () => {
        setTimeout(() => {
          item.classList.remove('btn-active')
        }, 100)
      })
    })

    // å»¶è¿ŸåŠ è½½è´´å›¾èƒŒæ™¯
    setTimeout(() => {
      this.isReadImages = true
    }, 1000)
  },

  watch: {
    // åˆ‡æ¢ç”»ç¬”é¢œè‰²
    curColorIndex() {
      this.curCanvasInstantiate.color = this.colorList[this.curColorIndex]
      if (this.mode === 2) {
        this.refreshDuilian()
      }
    },
    // åˆ‡æ¢ç”»å¸ƒæ—¶åº”ç”¨å½“å‰ç”»ç¬”é¢œè‰²å’Œå¤§å°
    curCanvasIndex() {
      this.curCanvasInstantiate.color = this.colorList[this.curColorIndex]
      this.handleChangeSize()
      window.scrollTo(0, 0)
    }
  },

  methods: {
    initMode1() {
      const { colorList, curColorIndex } = this
      this.canvasList.forEach((item, index) => {
        const options = {
          width: item.width,
          height: item.height,
          minWidth: MIN_WIDTH, // ç”»ç¬”æœ€å°å®½åº¦(px)
          maxWidth: MAX_WIDTH, // ç”»ç¬”æœ€å¤§å®½åº¦
          minSpeed: 1.8, // ç”»ç¬”è¾¾åˆ°æœ€å°å®½åº¦æ‰€éœ€æœ€å°é€Ÿåº¦(px/ms)ï¼Œå–å€¼èŒƒå›´1.0-10.0
          color: colorList[curColorIndex],
          // æ–°å¢çš„é…ç½®
          bgImage: item.bgImage,
        };

        this[INSTANTIATE_NAME + index] = new SmoothSignature(document.querySelector('.' + item.className), options);
      })
    },

    initMode2() {
      this.canvasTop = document.getElementById('canvas-top').getContext('2d')
      this.canvasLeft = document.getElementById('canvas-left').getContext('2d')
      this.canvasRight = document.getElementById('canvas-right').getContext('2d')

      // è®¾å­—ä½“æ ·å¼
      const font = "36px xs, cursive"
      this.canvasTop.font = font
      this.canvasLeft.font = font
      this.canvasRight.font = font

      // å¢å¼ºæ¸…æ™°åº¦
      const { scale } = this
      this.canvasTop.scale(scale, scale);
      this.canvasLeft.scale(scale, scale);
      this.canvasRight.scale(scale, scale);

      // è®¾èƒŒæ™¯å›¾
      this.imgObj1 = new Image()
      this.imgObj2 = new Image()
      this.imgObj1.src = hp
      this.imgObj2.src = dl
      this.imgObj1.onload = () => {
        // è´´èƒŒæ™¯
        this.canvasTop.drawImage(this.imgObj1, 0, 0, 200, 60)

        // å­—ä½“åŠ è½½å®Œæˆå
        document.fonts.ready.then(() => {
          this.handleTopFillText()
        });
      }
      this.imgObj2.onload = () => {
        // è´´èƒŒæ™¯
        this.canvasLeft.drawImage(this.imgObj2, 0, 0, 60, 364)
        this.canvasRight.drawImage(this.imgObj2, 0, 0, 60, 364)

        // å­—ä½“åŠ è½½å®Œæˆå
        document.fonts.ready.then(() => {
          this.handleLRFillText(this.canvasLeft, this.duilian.shang)
          this.handleLRFillText(this.canvasRight, this.duilian.xia)
        });
      }
    },

    // æ¨¡å¼2-åˆ·æ–°å¯¹è”
    refreshDuilian() {
      this.canvasTop.drawImage(this.imgObj1, 0, 0, 200, 60)
      this.canvasLeft.drawImage(this.imgObj2, 0, 0, 60, 364)
      this.canvasRight.drawImage(this.imgObj2, 0, 0, 60, 364)
      this.handleTopFillText()
      this.handleLRFillText(this.canvasLeft, this.duilian.shang)
      this.handleLRFillText(this.canvasRight, this.duilian.xia)
    },

    // æ¨¡å¼2-è´´æ¨ªæ‰¹
    handleTopFillText() {
      // è´´æ–‡æœ¬
      this.canvasTop.fillStyle = this.colorList[this.curColorIndex]
      if (this.duilian.heng) {
        this.duilian.heng.split('').forEach((item, index) => {
          const left = 42 * (index + 1) - 22
          this.canvasTop.fillText(item, left, 40)
        })
      }
    },

    // æ¨¡å¼2-è´´ä¸Šä¸‹è”
    handleLRFillText(ctx, text) {
      ctx.fillStyle = this.colorList[this.curColorIndex]
      if (text) {
        text.split('').forEach((item, index) => {
          const top = 50 * (index + 1) - 8
          ctx.fillText(item, 13, top)
        })
      }
    },

    // åˆ‡æ¢æ¨¡å¼
    toggleMode() {
      if (this.mode === 1) {
        this.mode = 2
        this.refreshDuilian()
      } else {
        this.mode = 1
      }
      localStorage.setItem('mode', this.mode);
    },

    // æ‰“å¼€è°ƒè‰²æ¿
    togglePalette() {
      this.colorListVisibility = !this.colorListVisibility
    },

    // å…³é—­è°ƒè‰²æ¿
    handleTouchstart(e) {
      // ä¸æ˜¯ç‚¹å‡»é€‰æ‹©é¢œè‰²æ—¶
      if (e.path[1]?.classList?.value !== 'colorList' && e.target.classList?.value !== 'cur-color') {
        this.colorListVisibility = false
      }
    },

    // é€‰æ‹©é¢œè‰²
    selectColor(index) {
      this.curColorIndex = index
      this.colorListVisibility = false
    },

    // åˆ‡æ¢ç”»å¸ƒ
    changeCanvas(index) {
      this.curCanvasIndex = index
    },

    // æ¸…ç©ºç”»å¸ƒ
    handleClear() {
      this.curCanvasInstantiate.clear();
    },

    // æ’¤é”€ç¬”ç”»
    handleUndo() {
      this.curCanvasInstantiate.undo();
    },

    // é¢„è§ˆ
    handlePreview() {
      this.showTopTip();
      this.isShowTip = true
      const _this = this
      ImagePreview({
        images: this.getImageList(),
        closeable: true,
        startPosition: this.curCanvasIndex,
        onClose() {
          _this.isShowTip = false
        },
      });
    },

    // æ‰“å¼€æµ·æŠ¥é¢„è§ˆ
    openPosters() {
      // åˆ›å»ºç”»å¸ƒ
      const canvas = document.createElement('canvas');
      canvas.width = BG_WIDTH
      canvas.height = BG_HEIGHT
      const ctx = canvas.getContext('2d');
      const resultImageList = [];

      // æ˜¯å¦éšè—ç¦å­—
      const isHideFu = this[INSTANTIATE_NAME + 3].isEmpty()
      this.bgList.forEach((item, index) => {
        // è´´èƒŒæ™¯å›¾
        ctx.drawImage(document.getElementById('bg-img-' + index), 0, 0, BG_WIDTH, BG_HEIGHT)

        // è´´å¯¹è”
        if (this.mode === 1) {
          this.canvasList.forEach((item, index) => {
            if (index === 3 && isHideFu) return;
            const dlCanvas = document.querySelector('.' + item.className)
            const { left, top, width, height } = POSITION[index]
            ctx.drawImage(dlCanvas, left, top, width, height)
          })
        } else {
          ['canvas-left', 'canvas-right', 'canvas-top'].forEach((item, index) => {
            const dlCanvas = document.getElementById(item)
            const { left, top, width, height } = POSITION[index]
            ctx.drawImage(dlCanvas, left, top, width, height)
          })
        }

        // è´´äºŒç»´ç 
        ctx.drawImage(document.getElementById("qrcode"), 40, 1280, 580, 136)

        // è´´æ–‡æœ¬
        ctx.font = "18px sans-serif"
        ctx.fillStyle = "#666666"
        ctx.fillText('Â©å…¬ä¼—å·ã€Œæœ‰è¶£ç ”ç©¶ç¤¾ã€', 550, 1420)

        // å¯¼å‡ºå›¾ç‰‡
        resultImageList.push(canvas.toDataURL('image/jpeg', 0.8))
      })

      // æ‰“å¼€å›¾ç‰‡é¢„è§ˆ
      this.isShowTip = true
      const _this = this
      ImagePreview({
        images: resultImageList,
        closeable: true,
        onClose() {
          _this.isShowTip = false
        },
      });
      this.showTopTip();
    },

    // å¼¹å‡ºé¡¶éƒ¨æç¤ºè¯­
    showTopTip() {
      if (!sessionStorage.getItem('showTip')) {
        sessionStorage.setItem('showTip', 'true');
        Notify({
          message: 'é•¿æŒ‰å›¾ç‰‡å¯ä¿å­˜åˆ°æœ¬åœ°',
          color: '#c33825',
          background: '#eed3ae',
        });
      }
    },

    // è·å–å¯¹è”å›¾ç‰‡åˆ—è¡¨
    getImageList(type = 'image/png') {
      const imageList = []
      this.canvasList.forEach((item, index) => {
        if (index === 3) {
          // `ç¦`å­—å¿…é¡»æ˜¯pngæ ¼å¼
          type = 'image/png'
        }
        imageList.push(this[INSTANTIATE_NAME + index].toDataURL(type, 0.8))
      })
      return imageList
    },

    // è¿›åº¦æ”¹å˜æ—¶
    changeProgress(progress) {
      this.progress = progress
      this.handleChangeSize()
    },

    // è°ƒæ•´ç”»ç¬”å¤§å°
    handleChangeSize() {
      const { progress } = this
      this.curCanvasInstantiate.minWidth = MIN_WIDTH * progress / 100
      this.curCanvasInstantiate.maxWidth = MAX_WIDTH * progress / 100
    },

    // åˆ·æ–°å¯¹è”
    handleRefresh(rotate) {
      this.duilian = duilianList[Math.floor(Math.random() * duilianList.length)]

      if (rotate) {
        if (this.mode === 2) {
          this.refreshDuilian()
        }
        // ä½¿iconæ—‹è½¬
        this.isRotate = true
        setTimeout(() => {
          this.isRotate = false
        }, 300)
      }
    },

    // æ’­æ”¾èƒŒæ™¯éŸ³ä¹
    handlePlay() {
      const { bgm } = this.$refs
      if (bgm.paused) {
        bgm.play()
        this.isPlay = true
      } else {
        bgm.pause()
        this.isPlay = false
      }
    },

    // å®Œæˆè¾“å…¥å¯¹è”
    handleSubmitInput(values) {
      this.duilian = values
      this.showInputBox = false
      this.refreshDuilian()
    },

    // å®ŒæˆæŒ‘é€‰å¯¹è”
    handlePickDuilian(item) {
      this.duilian = item
      this.showPickBox = false
      this.refreshDuilian()
    }
  },
};
</script>

```


æ›´å¤šæœ‰è¶£çš„å°ç½‘é¡µæ¬¢è¿å…³æ³¨å…¬ä¼—å·`æœ‰è¶£ç ”ç©¶ç¤¾`:
> [æ‰‹å†™æ˜¥è”](https://cl.xugaoyi.com/)</br>
> [FCåœ¨çº¿æ¨¡æ‹Ÿå™¨](https://game.xugaoyi.com/)</br>
> [çˆ±å›½å¤´åƒç”Ÿæˆå™¨](https://avatar.xugaoyi.com/)</br>
> [åˆ°è´¦è¯­éŸ³ç”Ÿæˆå™¨](https://zfb.xugaoyi.com/)
